{
  "hash": "3e264108d478a940366dfbbbcbd9478d",
  "result": {
    "markdown": "---\ntitle: 'üéüÔ∏è Cohort Analysis for Retail Businesses'\nsubtitle: ''\nabstract: 'By dividing customers into groups based on the time of their first purchase, businesses can compare the performance of different cohorts and identify trends and patterns that may not be visible when analyzing all customers as a single group.'\nauthor: 'Antonio Buzzelli'\ndate: \"2023-05-30\"\n# code-fold: true\n# draft: true\nfig-responsive: true\nfig-align: center\nfig-width: 10\n# fig-height: 10\nfig-dpi: 300\nimage: \"../../_freeze/posts/motogp-performance/performance/figure-html/cell-16-output-1.png\"\ncategories: [Online Retail, Cohort Analysis, R]\ndf-print: paged\n---\n\n\n\n\n# Key findings and achievements\n\n* \n* \n\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(arrow)\n```\n:::\n\n# Data\n\nOur dataset is composed by two-year sales data from an online store based in the UK. We first import the data and provide a glimpse of the dataframe.\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- arrow::read_parquet(\"../../data/concatenated_online_retail_II.parquet\")\ndf <- janitor::clean_names(df)\nhead(df)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"invoice\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"stock_code\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"description\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"quantity\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"invoice_date\"],\"name\":[5],\"type\":[\"dttm\"],\"align\":[\"right\"]},{\"label\":[\"price\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"customer_id\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"country\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"year\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"489434\",\"2\":\"85048\",\"3\":\"15CM CHRISTMAS GLASS BALL 20 LIGHTS\",\"4\":\"12\",\"5\":\"2009-12-01 08:45:00\",\"6\":\"6.95\",\"7\":\"13085\",\"8\":\"United Kingdom\",\"9\":\"1\"},{\"1\":\"489434\",\"2\":\"79323P\",\"3\":\"PINK CHERRY LIGHTS\",\"4\":\"12\",\"5\":\"2009-12-01 08:45:00\",\"6\":\"6.75\",\"7\":\"13085\",\"8\":\"United Kingdom\",\"9\":\"1\"},{\"1\":\"489434\",\"2\":\"79323W\",\"3\":\"WHITE CHERRY LIGHTS\",\"4\":\"12\",\"5\":\"2009-12-01 08:45:00\",\"6\":\"6.75\",\"7\":\"13085\",\"8\":\"United Kingdom\",\"9\":\"1\"},{\"1\":\"489434\",\"2\":\"22041\",\"3\":\"RECORD FRAME 7\\\" SINGLE SIZE\",\"4\":\"48\",\"5\":\"2009-12-01 08:45:00\",\"6\":\"2.10\",\"7\":\"13085\",\"8\":\"United Kingdom\",\"9\":\"1\"},{\"1\":\"489434\",\"2\":\"21232\",\"3\":\"STRAWBERRY CERAMIC TRINKET BOX\",\"4\":\"24\",\"5\":\"2009-12-01 08:45:00\",\"6\":\"1.25\",\"7\":\"13085\",\"8\":\"United Kingdom\",\"9\":\"1\"},{\"1\":\"489434\",\"2\":\"22064\",\"3\":\"PINK DOUGHNUT TRINKET POT\",\"4\":\"24\",\"5\":\"2009-12-01 08:45:00\",\"6\":\"1.65\",\"7\":\"13085\",\"8\":\"United Kingdom\",\"9\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,067,371\nColumns: 9\n$ invoice      <chr> \"489434\", \"489434\", \"489434\", \"489434\", \"489434\", \"489434‚Ä¶\n$ stock_code   <chr> \"85048\", \"79323P\", \"79323W\", \"22041\", \"21232\", \"22064\", \"‚Ä¶\n$ description  <chr> \"15CM CHRISTMAS GLASS BALL 20 LIGHTS\", \"PINK CHERRY LIGHT‚Ä¶\n$ quantity     <int> 12, 12, 12, 48, 24, 24, 24, 10, 12, 12, 24, 12, 10, 18, 3‚Ä¶\n$ invoice_date <dttm> 2009-12-01 08:45:00, 2009-12-01 08:45:00, 2009-12-01 08:‚Ä¶\n$ price        <dbl> 6.95, 6.75, 6.75, 2.10, 1.25, 1.65, 1.25, 5.95, 2.55, 3.7‚Ä¶\n$ customer_id  <dbl> 13085, 13085, 13085, 13085, 13085, 13085, 13085, 13085, 1‚Ä¶\n$ country      <chr> \"United Kingdom\", \"United Kingdom\", \"United Kingdom\", \"Un‚Ä¶\n$ year         <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ‚Ä¶\n```\n:::\n:::\n\n# Retention\n\nImplementing a cohort analysis is useful for a business to evaluate clients' retention over time.\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a column with the date in which the customer was first acquired\ndf <- df %>%\n  group_by(customer_id) %>%\n  mutate(customer_since = min(invoice_date))\n\n# Create a \"lifespan\" column\ndf$lifespan_m <- as.integer(\n  as.numeric(\n    difftime(df$invoice_date, df$customer_since, units = 'days')\n    ) / 30.44\n  )\n\ndf$cohort <- format(df$customer_since, \"%Y-%m\")\n\ngrouped <- df %>% \n  group_by(cohort, lifespan_m) %>% \n  summarize(n = n())\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngrouped\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"cohort\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"lifespan_m\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"2009-12\",\"2\":\"0\",\"3\":\"46528\"},{\"1\":\"2009-12\",\"2\":\"1\",\"3\":\"22973\"},{\"1\":\"2009-12\",\"2\":\"2\",\"3\":\"19762\"},{\"1\":\"2009-12\",\"2\":\"3\",\"3\":\"22048\"},{\"1\":\"2009-12\",\"2\":\"4\",\"3\":\"20282\"},{\"1\":\"2009-12\",\"2\":\"5\",\"3\":\"19969\"},{\"1\":\"2009-12\",\"2\":\"6\",\"3\":\"22170\"},{\"1\":\"2009-12\",\"2\":\"7\",\"3\":\"17191\"},{\"1\":\"2009-12\",\"2\":\"8\",\"3\":\"17930\"},{\"1\":\"2009-12\",\"2\":\"9\",\"3\":\"22740\"},{\"1\":\"2009-12\",\"2\":\"10\",\"3\":\"26184\"},{\"1\":\"2009-12\",\"2\":\"11\",\"3\":\"47561\"},{\"1\":\"2009-12\",\"2\":\"12\",\"3\":\"34806\"},{\"1\":\"2009-12\",\"2\":\"13\",\"3\":\"22606\"},{\"1\":\"2009-12\",\"2\":\"14\",\"3\":\"16492\"},{\"1\":\"2009-12\",\"2\":\"15\",\"3\":\"18670\"},{\"1\":\"2009-12\",\"2\":\"16\",\"3\":\"14961\"},{\"1\":\"2009-12\",\"2\":\"17\",\"3\":\"19547\"},{\"1\":\"2009-12\",\"2\":\"18\",\"3\":\"18340\"},{\"1\":\"2009-12\",\"2\":\"19\",\"3\":\"21521\"},{\"1\":\"2009-12\",\"2\":\"20\",\"3\":\"18106\"},{\"1\":\"2009-12\",\"2\":\"21\",\"3\":\"22655\"},{\"1\":\"2009-12\",\"2\":\"22\",\"3\":\"24635\"},{\"1\":\"2009-12\",\"2\":\"23\",\"3\":\"40692\"},{\"1\":\"2009-12\",\"2\":\"24\",\"3\":\"10040\"},{\"1\":\"2010-01\",\"2\":\"0\",\"3\":\"10500\"},{\"1\":\"2010-01\",\"2\":\"1\",\"3\":\"2973\"},{\"1\":\"2010-01\",\"2\":\"2\",\"3\":\"2877\"},{\"1\":\"2010-01\",\"2\":\"3\",\"3\":\"3272\"},{\"1\":\"2010-01\",\"2\":\"4\",\"3\":\"2837\"},{\"1\":\"2010-01\",\"2\":\"5\",\"3\":\"2245\"},{\"1\":\"2010-01\",\"2\":\"6\",\"3\":\"2451\"},{\"1\":\"2010-01\",\"2\":\"7\",\"3\":\"2506\"},{\"1\":\"2010-01\",\"2\":\"8\",\"3\":\"3853\"},{\"1\":\"2010-01\",\"2\":\"9\",\"3\":\"3262\"},{\"1\":\"2010-01\",\"2\":\"10\",\"3\":\"4082\"},{\"1\":\"2010-01\",\"2\":\"11\",\"3\":\"1468\"},{\"1\":\"2010-01\",\"2\":\"12\",\"3\":\"1844\"},{\"1\":\"2010-01\",\"2\":\"13\",\"3\":\"1959\"},{\"1\":\"2010-01\",\"2\":\"14\",\"3\":\"1773\"},{\"1\":\"2010-01\",\"2\":\"15\",\"3\":\"1974\"},{\"1\":\"2010-01\",\"2\":\"16\",\"3\":\"1919\"},{\"1\":\"2010-01\",\"2\":\"17\",\"3\":\"1998\"},{\"1\":\"2010-01\",\"2\":\"18\",\"3\":\"2023\"},{\"1\":\"2010-01\",\"2\":\"19\",\"3\":\"1905\"},{\"1\":\"2010-01\",\"2\":\"20\",\"3\":\"2792\"},{\"1\":\"2010-01\",\"2\":\"21\",\"3\":\"2813\"},{\"1\":\"2010-01\",\"2\":\"22\",\"3\":\"1512\"},{\"1\":\"2010-02\",\"2\":\"0\",\"3\":\"10598\"},{\"1\":\"2010-02\",\"2\":\"1\",\"3\":\"2127\"},{\"1\":\"2010-02\",\"2\":\"2\",\"3\":\"2900\"},{\"1\":\"2010-02\",\"2\":\"3\",\"3\":\"2200\"},{\"1\":\"2010-02\",\"2\":\"4\",\"3\":\"2276\"},{\"1\":\"2010-02\",\"2\":\"5\",\"3\":\"2229\"},{\"1\":\"2010-02\",\"2\":\"6\",\"3\":\"2175\"},{\"1\":\"2010-02\",\"2\":\"7\",\"3\":\"2774\"},{\"1\":\"2010-02\",\"2\":\"8\",\"3\":\"3523\"},{\"1\":\"2010-02\",\"2\":\"9\",\"3\":\"2629\"},{\"1\":\"2010-02\",\"2\":\"10\",\"3\":\"709\"},{\"1\":\"2010-02\",\"2\":\"11\",\"3\":\"1677\"},{\"1\":\"2010-02\",\"2\":\"12\",\"3\":\"1383\"},{\"1\":\"2010-02\",\"2\":\"13\",\"3\":\"1824\"},{\"1\":\"2010-02\",\"2\":\"14\",\"3\":\"1321\"},{\"1\":\"2010-02\",\"2\":\"15\",\"3\":\"2117\"},{\"1\":\"2010-02\",\"2\":\"16\",\"3\":\"1265\"},{\"1\":\"2010-02\",\"2\":\"17\",\"3\":\"1570\"},{\"1\":\"2010-02\",\"2\":\"18\",\"3\":\"1791\"},{\"1\":\"2010-02\",\"2\":\"19\",\"3\":\"2458\"},{\"1\":\"2010-02\",\"2\":\"20\",\"3\":\"2312\"},{\"1\":\"2010-02\",\"2\":\"21\",\"3\":\"1774\"},{\"1\":\"2010-02\",\"2\":\"22\",\"3\":\"71\"},{\"1\":\"2010-03\",\"2\":\"0\",\"3\":\"12762\"},{\"1\":\"2010-03\",\"2\":\"1\",\"3\":\"2971\"},{\"1\":\"2010-03\",\"2\":\"2\",\"3\":\"2918\"},{\"1\":\"2010-03\",\"2\":\"3\",\"3\":\"2972\"},{\"1\":\"2010-03\",\"2\":\"4\",\"3\":\"2426\"},{\"1\":\"2010-03\",\"2\":\"5\",\"3\":\"2384\"},{\"1\":\"2010-03\",\"2\":\"6\",\"3\":\"3639\"},{\"1\":\"2010-03\",\"2\":\"7\",\"3\":\"4060\"},{\"1\":\"2010-03\",\"2\":\"8\",\"3\":\"3602\"},{\"1\":\"2010-03\",\"2\":\"9\",\"3\":\"977\"},{\"1\":\"2010-03\",\"2\":\"10\",\"3\":\"1484\"},{\"1\":\"2010-03\",\"2\":\"11\",\"3\":\"1931\"},{\"1\":\"2010-03\",\"2\":\"12\",\"3\":\"1864\"},{\"1\":\"2010-03\",\"2\":\"13\",\"3\":\"1751\"},{\"1\":\"2010-03\",\"2\":\"14\",\"3\":\"1852\"},{\"1\":\"2010-03\",\"2\":\"15\",\"3\":\"1742\"},{\"1\":\"2010-03\",\"2\":\"16\",\"3\":\"2412\"},{\"1\":\"2010-03\",\"2\":\"17\",\"3\":\"1607\"},{\"1\":\"2010-03\",\"2\":\"18\",\"3\":\"2809\"},{\"1\":\"2010-03\",\"2\":\"19\",\"3\":\"2913\"},{\"1\":\"2010-03\",\"2\":\"20\",\"3\":\"2370\"},{\"1\":\"2010-03\",\"2\":\"21\",\"3\":\"144\"},{\"1\":\"2010-04\",\"2\":\"0\",\"3\":\"7181\"},{\"1\":\"2010-04\",\"2\":\"1\",\"3\":\"1162\"},{\"1\":\"2010-04\",\"2\":\"2\",\"3\":\"1113\"},{\"1\":\"2010-04\",\"2\":\"3\",\"3\":\"858\"},{\"1\":\"2010-04\",\"2\":\"4\",\"3\":\"1277\"},{\"1\":\"2010-04\",\"2\":\"5\",\"3\":\"1807\"},{\"1\":\"2010-04\",\"2\":\"6\",\"3\":\"2215\"},{\"1\":\"2010-04\",\"2\":\"7\",\"3\":\"1432\"},{\"1\":\"2010-04\",\"2\":\"8\",\"3\":\"532\"},{\"1\":\"2010-04\",\"2\":\"9\",\"3\":\"844\"},{\"1\":\"2010-04\",\"2\":\"10\",\"3\":\"648\"},{\"1\":\"2010-04\",\"2\":\"11\",\"3\":\"986\"},{\"1\":\"2010-04\",\"2\":\"12\",\"3\":\"776\"},{\"1\":\"2010-04\",\"2\":\"13\",\"3\":\"994\"},{\"1\":\"2010-04\",\"2\":\"14\",\"3\":\"903\"},{\"1\":\"2010-04\",\"2\":\"15\",\"3\":\"791\"},{\"1\":\"2010-04\",\"2\":\"16\",\"3\":\"744\"},{\"1\":\"2010-04\",\"2\":\"17\",\"3\":\"1705\"},{\"1\":\"2010-04\",\"2\":\"18\",\"3\":\"1424\"},{\"1\":\"2010-04\",\"2\":\"19\",\"3\":\"1139\"},{\"1\":\"2010-04\",\"2\":\"20\",\"3\":\"19\"},{\"1\":\"2010-05\",\"2\":\"0\",\"3\":\"6926\"},{\"1\":\"2010-05\",\"2\":\"1\",\"3\":\"710\"},{\"1\":\"2010-05\",\"2\":\"2\",\"3\":\"976\"},{\"1\":\"2010-05\",\"2\":\"3\",\"3\":\"529\"},{\"1\":\"2010-05\",\"2\":\"4\",\"3\":\"1644\"},{\"1\":\"2010-05\",\"2\":\"5\",\"3\":\"1752\"},{\"1\":\"2010-05\",\"2\":\"6\",\"3\":\"1693\"},{\"1\":\"2010-05\",\"2\":\"7\",\"3\":\"452\"},{\"1\":\"2010-05\",\"2\":\"8\",\"3\":\"323\"},{\"1\":\"2010-05\",\"2\":\"9\",\"3\":\"425\"},{\"1\":\"2010-05\",\"2\":\"10\",\"3\":\"910\"},{\"1\":\"2010-05\",\"2\":\"11\",\"3\":\"742\"},{\"1\":\"2010-05\",\"2\":\"12\",\"3\":\"625\"},{\"1\":\"2010-05\",\"2\":\"13\",\"3\":\"731\"},{\"1\":\"2010-05\",\"2\":\"14\",\"3\":\"667\"},{\"1\":\"2010-05\",\"2\":\"15\",\"3\":\"664\"},{\"1\":\"2010-05\",\"2\":\"16\",\"3\":\"1278\"},{\"1\":\"2010-05\",\"2\":\"17\",\"3\":\"1120\"},{\"1\":\"2010-05\",\"2\":\"18\",\"3\":\"1009\"},{\"1\":\"2010-05\",\"2\":\"19\",\"3\":\"32\"},{\"1\":\"2010-06\",\"2\":\"0\",\"3\":\"8218\"},{\"1\":\"2010-06\",\"2\":\"1\",\"3\":\"1146\"},{\"1\":\"2010-06\",\"2\":\"2\",\"3\":\"1104\"},{\"1\":\"2010-06\",\"2\":\"3\",\"3\":\"2150\"},{\"1\":\"2010-06\",\"2\":\"4\",\"3\":\"1617\"},{\"1\":\"2010-06\",\"2\":\"5\",\"3\":\"2677\"},{\"1\":\"2010-06\",\"2\":\"6\",\"3\":\"573\"},{\"1\":\"2010-06\",\"2\":\"7\",\"3\":\"609\"},{\"1\":\"2010-06\",\"2\":\"8\",\"3\":\"446\"},{\"1\":\"2010-06\",\"2\":\"9\",\"3\":\"691\"},{\"1\":\"2010-06\",\"2\":\"10\",\"3\":\"908\"},{\"1\":\"2010-06\",\"2\":\"11\",\"3\":\"872\"},{\"1\":\"2010-06\",\"2\":\"12\",\"3\":\"911\"},{\"1\":\"2010-06\",\"2\":\"13\",\"3\":\"908\"},{\"1\":\"2010-06\",\"2\":\"14\",\"3\":\"942\"},{\"1\":\"2010-06\",\"2\":\"15\",\"3\":\"1000\"},{\"1\":\"2010-06\",\"2\":\"16\",\"3\":\"1451\"},{\"1\":\"2010-06\",\"2\":\"17\",\"3\":\"1236\"},{\"1\":\"2010-06\",\"2\":\"18\",\"3\":\"97\"},{\"1\":\"2010-07\",\"2\":\"0\",\"3\":\"5447\"},{\"1\":\"2010-07\",\"2\":\"1\",\"3\":\"790\"},{\"1\":\"2010-07\",\"2\":\"2\",\"3\":\"1693\"},{\"1\":\"2010-07\",\"2\":\"3\",\"3\":\"1751\"},{\"1\":\"2010-07\",\"2\":\"4\",\"3\":\"1890\"},{\"1\":\"2010-07\",\"2\":\"5\",\"3\":\"396\"},{\"1\":\"2010-07\",\"2\":\"6\",\"3\":\"716\"},{\"1\":\"2010-07\",\"2\":\"7\",\"3\":\"575\"},{\"1\":\"2010-07\",\"2\":\"8\",\"3\":\"1063\"},{\"1\":\"2010-07\",\"2\":\"9\",\"3\":\"356\"},{\"1\":\"2010-07\",\"2\":\"10\",\"3\":\"694\"},{\"1\":\"2010-07\",\"2\":\"11\",\"3\":\"764\"},{\"1\":\"2010-07\",\"2\":\"12\",\"3\":\"693\"},{\"1\":\"2010-07\",\"2\":\"13\",\"3\":\"667\"},{\"1\":\"2010-07\",\"2\":\"14\",\"3\":\"1045\"},{\"1\":\"2010-07\",\"2\":\"15\",\"3\":\"1352\"},{\"1\":\"2010-07\",\"2\":\"16\",\"3\":\"1225\"},{\"1\":\"2010-07\",\"2\":\"17\",\"3\":\"92\"},{\"1\":\"2010-08\",\"2\":\"0\",\"3\":\"5103\"},{\"1\":\"2010-08\",\"2\":\"1\",\"3\":\"1125\"},{\"1\":\"2010-08\",\"2\":\"2\",\"3\":\"1733\"},{\"1\":\"2010-08\",\"2\":\"3\",\"3\":\"1554\"},{\"1\":\"2010-08\",\"2\":\"4\",\"3\":\"495\"},{\"1\":\"2010-08\",\"2\":\"5\",\"3\":\"454\"},{\"1\":\"2010-08\",\"2\":\"6\",\"3\":\"433\"},{\"1\":\"2010-08\",\"2\":\"7\",\"3\":\"453\"},{\"1\":\"2010-08\",\"2\":\"8\",\"3\":\"607\"},{\"1\":\"2010-08\",\"2\":\"9\",\"3\":\"534\"},{\"1\":\"2010-08\",\"2\":\"10\",\"3\":\"630\"},{\"1\":\"2010-08\",\"2\":\"11\",\"3\":\"680\"},{\"1\":\"2010-08\",\"2\":\"12\",\"3\":\"1008\"},{\"1\":\"2010-08\",\"2\":\"13\",\"3\":\"702\"},{\"1\":\"2010-08\",\"2\":\"14\",\"3\":\"1441\"},{\"1\":\"2010-08\",\"2\":\"15\",\"3\":\"623\"},{\"1\":\"2010-08\",\"2\":\"16\",\"3\":\"17\"},{\"1\":\"2010-09\",\"2\":\"0\",\"3\":\"7279\"},{\"1\":\"2010-09\",\"2\":\"1\",\"3\":\"1955\"},{\"1\":\"2010-09\",\"2\":\"2\",\"3\":\"1825\"},{\"1\":\"2010-09\",\"2\":\"3\",\"3\":\"1058\"},{\"1\":\"2010-09\",\"2\":\"4\",\"3\":\"529\"},{\"1\":\"2010-09\",\"2\":\"5\",\"3\":\"900\"},{\"1\":\"2010-09\",\"2\":\"6\",\"3\":\"678\"},{\"1\":\"2010-09\",\"2\":\"7\",\"3\":\"473\"},{\"1\":\"2010-09\",\"2\":\"8\",\"3\":\"567\"},{\"1\":\"2010-09\",\"2\":\"9\",\"3\":\"630\"},{\"1\":\"2010-09\",\"2\":\"10\",\"3\":\"619\"},{\"1\":\"2010-09\",\"2\":\"11\",\"3\":\"1148\"},{\"1\":\"2010-09\",\"2\":\"12\",\"3\":\"1234\"},{\"1\":\"2010-09\",\"2\":\"13\",\"3\":\"1538\"},{\"1\":\"2010-09\",\"2\":\"14\",\"3\":\"706\"},{\"1\":\"2010-10\",\"2\":\"0\",\"3\":\"12745\"},{\"1\":\"2010-10\",\"2\":\"1\",\"3\":\"3769\"},{\"1\":\"2010-10\",\"2\":\"2\",\"3\":\"966\"},{\"1\":\"2010-10\",\"2\":\"3\",\"3\":\"1259\"},{\"1\":\"2010-10\",\"2\":\"4\",\"3\":\"1206\"},{\"1\":\"2010-10\",\"2\":\"5\",\"3\":\"1344\"},{\"1\":\"2010-10\",\"2\":\"6\",\"3\":\"1248\"},{\"1\":\"2010-10\",\"2\":\"7\",\"3\":\"1229\"},{\"1\":\"2010-10\",\"2\":\"8\",\"3\":\"1012\"},{\"1\":\"2010-10\",\"2\":\"9\",\"3\":\"1157\"},{\"1\":\"2010-10\",\"2\":\"10\",\"3\":\"999\"},{\"1\":\"2010-10\",\"2\":\"11\",\"3\":\"2030\"},{\"1\":\"2010-10\",\"2\":\"12\",\"3\":\"2594\"},{\"1\":\"2010-10\",\"2\":\"13\",\"3\":\"2035\"},{\"1\":\"2010-10\",\"2\":\"14\",\"3\":\"150\"},{\"1\":\"2010-11\",\"2\":\"0\",\"3\":\"13134\"},{\"1\":\"2010-11\",\"2\":\"1\",\"3\":\"983\"},{\"1\":\"2010-11\",\"2\":\"2\",\"3\":\"878\"},{\"1\":\"2010-11\",\"2\":\"3\",\"3\":\"660\"},{\"1\":\"2010-11\",\"2\":\"4\",\"3\":\"949\"},{\"1\":\"2010-11\",\"2\":\"5\",\"3\":\"771\"},{\"1\":\"2010-11\",\"2\":\"6\",\"3\":\"924\"},{\"1\":\"2010-11\",\"2\":\"7\",\"3\":\"614\"},{\"1\":\"2010-11\",\"2\":\"8\",\"3\":\"592\"},{\"1\":\"2010-11\",\"2\":\"9\",\"3\":\"835\"},{\"1\":\"2010-11\",\"2\":\"10\",\"3\":\"1242\"},{\"1\":\"2010-11\",\"2\":\"11\",\"3\":\"2881\"},{\"1\":\"2010-11\",\"2\":\"12\",\"3\":\"2195\"},{\"1\":\"2010-11\",\"2\":\"13\",\"3\":\"112\"},{\"1\":\"2010-12\",\"2\":\"0\",\"3\":\"3280\"},{\"1\":\"2010-12\",\"2\":\"1\",\"3\":\"198\"},{\"1\":\"2010-12\",\"2\":\"2\",\"3\":\"87\"},{\"1\":\"2010-12\",\"2\":\"3\",\"3\":\"194\"},{\"1\":\"2010-12\",\"2\":\"4\",\"3\":\"92\"},{\"1\":\"2010-12\",\"2\":\"5\",\"3\":\"117\"},{\"1\":\"2010-12\",\"2\":\"6\",\"3\":\"35\"},{\"1\":\"2010-12\",\"2\":\"7\",\"3\":\"139\"},{\"1\":\"2010-12\",\"2\":\"8\",\"3\":\"55\"},{\"1\":\"2010-12\",\"2\":\"9\",\"3\":\"50\"},{\"1\":\"2010-12\",\"2\":\"10\",\"3\":\"206\"},{\"1\":\"2010-12\",\"2\":\"11\",\"3\":\"391\"},{\"1\":\"2010-12\",\"2\":\"12\",\"3\":\"22\"},{\"1\":\"2011-01\",\"2\":\"0\",\"3\":\"2340\"},{\"1\":\"2011-01\",\"2\":\"1\",\"3\":\"288\"},{\"1\":\"2011-01\",\"2\":\"2\",\"3\":\"387\"},{\"1\":\"2011-01\",\"2\":\"3\",\"3\":\"410\"},{\"1\":\"2011-01\",\"2\":\"4\",\"3\":\"321\"},{\"1\":\"2011-01\",\"2\":\"5\",\"3\":\"318\"},{\"1\":\"2011-01\",\"2\":\"6\",\"3\":\"212\"},{\"1\":\"2011-01\",\"2\":\"7\",\"3\":\"261\"},{\"1\":\"2011-01\",\"2\":\"8\",\"3\":\"518\"},{\"1\":\"2011-01\",\"2\":\"9\",\"3\":\"908\"},{\"1\":\"2011-01\",\"2\":\"10\",\"3\":\"246\"},{\"1\":\"2011-02\",\"2\":\"0\",\"3\":\"2934\"},{\"1\":\"2011-02\",\"2\":\"1\",\"3\":\"719\"},{\"1\":\"2011-02\",\"2\":\"2\",\"3\":\"597\"},{\"1\":\"2011-02\",\"2\":\"3\",\"3\":\"707\"},{\"1\":\"2011-02\",\"2\":\"4\",\"3\":\"480\"},{\"1\":\"2011-02\",\"2\":\"5\",\"3\":\"392\"},{\"1\":\"2011-02\",\"2\":\"6\",\"3\":\"383\"},{\"1\":\"2011-02\",\"2\":\"7\",\"3\":\"441\"},{\"1\":\"2011-02\",\"2\":\"8\",\"3\":\"445\"},{\"1\":\"2011-02\",\"2\":\"9\",\"3\":\"289\"},{\"1\":\"2011-03\",\"2\":\"0\",\"3\":\"5056\"},{\"1\":\"2011-03\",\"2\":\"1\",\"3\":\"722\"},{\"1\":\"2011-03\",\"2\":\"2\",\"3\":\"1090\"},{\"1\":\"2011-03\",\"2\":\"3\",\"3\":\"866\"},{\"1\":\"2011-03\",\"2\":\"4\",\"3\":\"728\"},{\"1\":\"2011-03\",\"2\":\"5\",\"3\":\"584\"},{\"1\":\"2011-03\",\"2\":\"6\",\"3\":\"970\"},{\"1\":\"2011-03\",\"2\":\"7\",\"3\":\"1464\"},{\"1\":\"2011-03\",\"2\":\"8\",\"3\":\"1246\"},{\"1\":\"2011-03\",\"2\":\"9\",\"3\":\"142\"},{\"1\":\"2011-04\",\"2\":\"0\",\"3\":\"2752\"},{\"1\":\"2011-04\",\"2\":\"1\",\"3\":\"908\"},{\"1\":\"2011-04\",\"2\":\"2\",\"3\":\"369\"},{\"1\":\"2011-04\",\"2\":\"3\",\"3\":\"486\"},{\"1\":\"2011-04\",\"2\":\"4\",\"3\":\"422\"},{\"1\":\"2011-04\",\"2\":\"5\",\"3\":\"652\"},{\"1\":\"2011-04\",\"2\":\"6\",\"3\":\"747\"},{\"1\":\"2011-04\",\"2\":\"7\",\"3\":\"678\"},{\"1\":\"2011-04\",\"2\":\"8\",\"3\":\"108\"},{\"1\":\"2011-05\",\"2\":\"0\",\"3\":\"2512\"},{\"1\":\"2011-05\",\"2\":\"1\",\"3\":\"569\"},{\"1\":\"2011-05\",\"2\":\"2\",\"3\":\"476\"},{\"1\":\"2011-05\",\"2\":\"3\",\"3\":\"509\"},{\"1\":\"2011-05\",\"2\":\"4\",\"3\":\"769\"},{\"1\":\"2011-05\",\"2\":\"5\",\"3\":\"444\"},{\"1\":\"2011-05\",\"2\":\"6\",\"3\":\"778\"},{\"1\":\"2011-05\",\"2\":\"7\",\"3\":\"6\"},{\"1\":\"2011-06\",\"2\":\"0\",\"3\":\"3360\"},{\"1\":\"2011-06\",\"2\":\"1\",\"3\":\"402\"},{\"1\":\"2011-06\",\"2\":\"2\",\"3\":\"584\"},{\"1\":\"2011-06\",\"2\":\"3\",\"3\":\"737\"},{\"1\":\"2011-06\",\"2\":\"4\",\"3\":\"761\"},{\"1\":\"2011-06\",\"2\":\"5\",\"3\":\"799\"},{\"1\":\"2011-06\",\"2\":\"6\",\"3\":\"36\"},{\"1\":\"2011-07\",\"2\":\"0\",\"3\":\"3534\"},{\"1\":\"2011-07\",\"2\":\"1\",\"3\":\"691\"},{\"1\":\"2011-07\",\"2\":\"2\",\"3\":\"1154\"},{\"1\":\"2011-07\",\"2\":\"3\",\"3\":\"989\"},{\"1\":\"2011-07\",\"2\":\"4\",\"3\":\"1299\"},{\"1\":\"2011-08\",\"2\":\"0\",\"3\":\"3877\"},{\"1\":\"2011-08\",\"2\":\"1\",\"3\":\"2199\"},{\"1\":\"2011-08\",\"2\":\"2\",\"3\":\"3173\"},{\"1\":\"2011-08\",\"2\":\"3\",\"3\":\"1007\"},{\"1\":\"2011-08\",\"2\":\"4\",\"3\":\"18\"},{\"1\":\"2011-09\",\"2\":\"0\",\"3\":\"6425\"},{\"1\":\"2011-09\",\"2\":\"1\",\"3\":\"2016\"},{\"1\":\"2011-09\",\"2\":\"2\",\"3\":\"1785\"},{\"1\":\"2011-09\",\"2\":\"3\",\"3\":\"73\"},{\"1\":\"2011-10\",\"2\":\"0\",\"3\":\"9595\"},{\"1\":\"2011-10\",\"2\":\"1\",\"3\":\"2144\"},{\"1\":\"2011-10\",\"2\":\"2\",\"3\":\"69\"},{\"1\":\"2011-11\",\"2\":\"0\",\"3\":\"7078\"},{\"1\":\"2011-11\",\"2\":\"1\",\"3\":\"91\"},{\"1\":\"2011-12\",\"2\":\"0\",\"3\":\"653\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncohorts_abs <- pivot_wider(grouped, id_cols = 'cohort', names_from = 'lifespan_m', values_from = 'n')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncohorts_perc <- data.frame(lapply(cohorts_abs[,-1], function(x) x / cohorts_abs$'0' * 100))\ncohorts_perc <- cbind(cohorts_abs[1], cohorts_perc)\ncohorts_perc\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"cohort\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"X0\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X1\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X2\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X3\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X4\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X5\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X6\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X7\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X8\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X9\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X10\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X11\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X12\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X13\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X14\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X15\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X16\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X17\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X18\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X19\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X20\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X21\"],\"name\":[23],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X22\"],\"name\":[24],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X23\"],\"name\":[25],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X24\"],\"name\":[26],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"2009-12\",\"2\":\"100\",\"3\":\"49.374570\",\"4\":\"42.4733494\",\"5\":\"47.386520\",\"6\":\"43.5909560\",\"7\":\"42.918243\",\"8\":\"47.648728\",\"9\":\"36.9476444\",\"10\":\"38.535935\",\"11\":\"48.873796\",\"12\":\"56.275791\",\"13\":\"102.22017\",\"14\":\"74.8065681\",\"15\":\"48.5857978\",\"16\":\"35.445323\",\"17\":\"40.126376\",\"18\":\"32.1548315\",\"19\":\"42.011262\",\"20\":\"39.417125\",\"21\":\"46.2538686\",\"22\":\"38.9142022\",\"23\":\"48.69111\",\"24\":\"52.9466128\",\"25\":\"87.45702\",\"26\":\"21.5784\"},{\"1\":\"2010-01\",\"2\":\"100\",\"3\":\"28.314286\",\"4\":\"27.4000000\",\"5\":\"31.161905\",\"6\":\"27.0190476\",\"7\":\"21.380952\",\"8\":\"23.342857\",\"9\":\"23.8666667\",\"10\":\"36.695238\",\"11\":\"31.066667\",\"12\":\"38.876190\",\"13\":\"13.98095\",\"14\":\"17.5619048\",\"15\":\"18.6571429\",\"16\":\"16.885714\",\"17\":\"18.800000\",\"18\":\"18.2761905\",\"19\":\"19.028571\",\"20\":\"19.266667\",\"21\":\"18.1428571\",\"22\":\"26.5904762\",\"23\":\"26.79048\",\"24\":\"14.4000000\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2010-02\",\"2\":\"100\",\"3\":\"20.069824\",\"4\":\"27.3636535\",\"5\":\"20.758634\",\"6\":\"21.4757501\",\"7\":\"21.032270\",\"8\":\"20.522740\",\"9\":\"26.1747500\",\"10\":\"33.242121\",\"11\":\"24.806567\",\"12\":\"6.689941\",\"13\":\"15.82374\",\"14\":\"13.0496320\",\"15\":\"17.2107945\",\"16\":\"12.464616\",\"17\":\"19.975467\",\"18\":\"11.9362144\",\"19\":\"14.814116\",\"20\":\"16.899415\",\"21\":\"23.1930553\",\"22\":\"21.8154369\",\"23\":\"16.73901\",\"24\":\"0.6699377\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2010-03\",\"2\":\"100\",\"3\":\"23.280050\",\"4\":\"22.8647547\",\"5\":\"23.287886\",\"6\":\"19.0095596\",\"7\":\"18.680458\",\"8\":\"28.514339\",\"9\":\"31.8131954\",\"10\":\"28.224416\",\"11\":\"7.655540\",\"12\":\"11.628271\",\"13\":\"15.13086\",\"14\":\"14.6058612\",\"15\":\"13.7204200\",\"16\":\"14.511832\",\"17\":\"13.649898\",\"18\":\"18.8998590\",\"19\":\"12.592070\",\"20\":\"22.010657\",\"21\":\"22.8255759\",\"22\":\"18.5707569\",\"23\":\"1.12835\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2010-04\",\"2\":\"100\",\"3\":\"16.181590\",\"4\":\"15.4992341\",\"5\":\"11.948197\",\"6\":\"17.7830386\",\"7\":\"25.163626\",\"8\":\"30.845286\",\"9\":\"19.9415123\",\"10\":\"7.408439\",\"11\":\"11.753238\",\"12\":\"9.023813\",\"13\":\"13.73068\",\"14\":\"10.8062944\",\"15\":\"13.8420833\",\"16\":\"12.574850\",\"17\":\"11.015179\",\"18\":\"10.3606740\",\"19\":\"23.743211\",\"20\":\"19.830107\",\"21\":\"15.8613007\",\"22\":\"0.2645871\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2010-05\",\"2\":\"100\",\"3\":\"10.251227\",\"4\":\"14.0918279\",\"5\":\"7.637886\",\"6\":\"23.7366445\",\"7\":\"25.295986\",\"8\":\"24.444124\",\"9\":\"6.5261334\",\"10\":\"4.663586\",\"11\":\"6.136298\",\"12\":\"13.138897\",\"13\":\"10.71325\",\"14\":\"9.0239677\",\"15\":\"10.5544326\",\"16\":\"9.630378\",\"17\":\"9.587063\",\"18\":\"18.4522091\",\"19\":\"16.170950\",\"20\":\"14.568293\",\"21\":\"0.4620271\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2010-06\",\"2\":\"100\",\"3\":\"13.944999\",\"4\":\"13.4339255\",\"5\":\"26.162083\",\"6\":\"19.6763203\",\"7\":\"32.574836\",\"8\":\"6.972499\",\"9\":\"7.4105622\",\"10\":\"5.427111\",\"11\":\"8.408372\",\"12\":\"11.048917\",\"13\":\"10.61085\",\"14\":\"11.0854222\",\"15\":\"11.0489170\",\"16\":\"11.462643\",\"17\":\"12.168411\",\"18\":\"17.6563641\",\"19\":\"15.040156\",\"20\":\"1.180336\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2010-07\",\"2\":\"100\",\"3\":\"14.503396\",\"4\":\"31.0813292\",\"5\":\"32.146135\",\"6\":\"34.6979989\",\"7\":\"7.270057\",\"8\":\"13.144850\",\"9\":\"10.5562695\",\"10\":\"19.515330\",\"11\":\"6.535708\",\"12\":\"12.740958\",\"13\":\"14.02607\",\"14\":\"12.7225996\",\"15\":\"12.2452726\",\"16\":\"19.184872\",\"17\":\"24.821002\",\"18\":\"22.4894437\",\"19\":\"1.689003\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2010-08\",\"2\":\"100\",\"3\":\"22.045855\",\"4\":\"33.9604154\",\"5\":\"30.452675\",\"6\":\"9.7001764\",\"7\":\"8.896727\",\"8\":\"8.485205\",\"9\":\"8.8771311\",\"10\":\"11.894964\",\"11\":\"10.464433\",\"12\":\"12.345679\",\"13\":\"13.32549\",\"14\":\"19.7530864\",\"15\":\"13.7566138\",\"16\":\"28.238291\",\"17\":\"12.208505\",\"18\":\"0.3331374\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2010-09\",\"2\":\"100\",\"3\":\"26.858085\",\"4\":\"25.0721253\",\"5\":\"14.534964\",\"6\":\"7.2674818\",\"7\":\"12.364336\",\"8\":\"9.314466\",\"9\":\"6.4981453\",\"10\":\"7.789532\",\"11\":\"8.655035\",\"12\":\"8.503915\",\"13\":\"15.77140\",\"14\":\"16.9528781\",\"15\":\"21.1292760\",\"16\":\"9.699134\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2010-10\",\"2\":\"100\",\"3\":\"29.572381\",\"4\":\"7.5794429\",\"5\":\"9.878384\",\"6\":\"9.4625343\",\"7\":\"10.545312\",\"8\":\"9.792075\",\"9\":\"9.6429973\",\"10\":\"7.940369\",\"11\":\"9.078070\",\"12\":\"7.838368\",\"13\":\"15.92781\",\"14\":\"20.3530796\",\"15\":\"15.9670459\",\"16\":\"1.176932\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2010-11\",\"2\":\"100\",\"3\":\"7.484392\",\"4\":\"6.6849399\",\"5\":\"5.025126\",\"6\":\"7.2255215\",\"7\":\"5.870260\",\"8\":\"7.035176\",\"9\":\"4.6748896\",\"10\":\"4.507385\",\"11\":\"6.357545\",\"12\":\"9.456373\",\"13\":\"21.93543\",\"14\":\"16.7123496\",\"15\":\"0.8527486\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2010-12\",\"2\":\"100\",\"3\":\"6.036585\",\"4\":\"2.6524390\",\"5\":\"5.914634\",\"6\":\"2.8048780\",\"7\":\"3.567073\",\"8\":\"1.067073\",\"9\":\"4.2378049\",\"10\":\"1.676829\",\"11\":\"1.524390\",\"12\":\"6.280488\",\"13\":\"11.92073\",\"14\":\"0.6707317\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2011-01\",\"2\":\"100\",\"3\":\"12.307692\",\"4\":\"16.5384615\",\"5\":\"17.521368\",\"6\":\"13.7179487\",\"7\":\"13.589744\",\"8\":\"9.059829\",\"9\":\"11.1538462\",\"10\":\"22.136752\",\"11\":\"38.803419\",\"12\":\"10.512821\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2011-02\",\"2\":\"100\",\"3\":\"24.505794\",\"4\":\"20.3476483\",\"5\":\"24.096796\",\"6\":\"16.3599182\",\"7\":\"13.360600\",\"8\":\"13.053851\",\"9\":\"15.0306748\",\"10\":\"15.167007\",\"11\":\"9.850034\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2011-03\",\"2\":\"100\",\"3\":\"14.280063\",\"4\":\"21.5585443\",\"5\":\"17.128165\",\"6\":\"14.3987342\",\"7\":\"11.550633\",\"8\":\"19.185127\",\"9\":\"28.9556962\",\"10\":\"24.643987\",\"11\":\"2.808544\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2011-04\",\"2\":\"100\",\"3\":\"32.994186\",\"4\":\"13.4084302\",\"5\":\"17.659884\",\"6\":\"15.3343023\",\"7\":\"23.691860\",\"8\":\"27.143895\",\"9\":\"24.6366279\",\"10\":\"3.924419\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2011-05\",\"2\":\"100\",\"3\":\"22.651274\",\"4\":\"18.9490446\",\"5\":\"20.262739\",\"6\":\"30.6130573\",\"7\":\"17.675159\",\"8\":\"30.971338\",\"9\":\"0.2388535\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2011-06\",\"2\":\"100\",\"3\":\"11.964286\",\"4\":\"17.3809524\",\"5\":\"21.934524\",\"6\":\"22.6488095\",\"7\":\"23.779762\",\"8\":\"1.071429\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2011-07\",\"2\":\"100\",\"3\":\"19.552915\",\"4\":\"32.6542162\",\"5\":\"27.985286\",\"6\":\"36.7572156\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2011-08\",\"2\":\"100\",\"3\":\"56.719113\",\"4\":\"81.8416301\",\"5\":\"25.973691\",\"6\":\"0.4642765\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2011-09\",\"2\":\"100\",\"3\":\"31.377432\",\"4\":\"27.7821012\",\"5\":\"1.136187\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2011-10\",\"2\":\"100\",\"3\":\"22.344971\",\"4\":\"0.7191245\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2011-11\",\"2\":\"100\",\"3\":\"1.285674\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"},{\"1\":\"2011-12\",\"2\":\"100\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\",\"13\":\"NA\",\"14\":\"NA\",\"15\":\"NA\",\"16\":\"NA\",\"17\":\"NA\",\"18\":\"NA\",\"19\":\"NA\",\"20\":\"NA\",\"21\":\"NA\",\"22\":\"NA\",\"23\":\"NA\",\"24\":\"NA\",\"25\":\"NA\",\"26\":\"NA\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncohorts_perc_long <- pivot_longer(cohorts_perc, cols = names(cohorts_perc[-1]), names_to = 'lifespan', values_to = 'retention_rate')\n\nggplot(cohorts_perc_long, aes(fct(lifespan), fct_rev(cohort)) ) +\n  geom_tile(aes(fill = retention_rate)) +\n  scale_fill_gradient() +\n  labs(title = \"Cohort Analysis - Retention\", x = \"Lifespan\", y = \"Cohort\") +\n  theme(aspect.ratio = 0.5)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=3000}\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}